const handleFileView = async (attachmentId) => {
  try {
    const response = await apiRequest(
      "GET",
      `${process.env.REACT_APP_BACKEND_URL}/api/v1/attachment/fetch-document/${attachmentId}`
    );

    const signedUrl = response.data?.signedUrl;

    if (!signedUrl) {
      toast.error("Failed to fetch this Document");
      return;
    }

    const fileExtension = signedUrl.split('.').pop().split(/\#|\?/)[0]?.toLowerCase();

    const isExcel =
      fileExtension === "xls" ||
      fileExtension === "xlsx" ||
      fileExtension === "csv";

    setPreviewUrl(
      isExcel
        ? `https://view.officeapps.live.com/op/embed.aspx?src=${encodeURIComponent(signedUrl)}`
        : signedUrl
    );
  } catch (error) {
    console.error("Error fetching preview URL:", error);
    toast.error("Failed to fetch this Document");
  }
};
