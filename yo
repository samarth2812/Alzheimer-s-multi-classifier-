exportToExcel: async (params = {}) => {
  try {
    const queryParams = new URLSearchParams();

    Object.keys(params).forEach((key) => {
      if (key !== "page" && key !== "limit" && params[key]) {
        queryParams.append(key, params[key]);
      }
    });

    const response = await apiRequest(
      "GET",
      `${getBaseUrl()}${getExportEndpoint()}?${queryParams.toString()}`,
      null,
      { responseType: "blob" }
    );

    const url = window.URL.createObjectURL(response.data);
    const link = document.createElement("a");
    link.href = url;

    const timestamp = new Date().toISOString().replace(/[:.]/g, "-");
    link.setAttribute("download", `${moduleType}_${timestamp}.xlsx`);
    document.body.appendChild(link);
    link.click();

    // Clean up
    document.body.removeChild(link);
    window.URL.revokeObjectURL(url);

    return true;
  } catch (error) {
    console.log("Error exporting Excel:", error);
    throw error;
  }
}
