    for (const assignee of assignees) {
      try {
        const emailData: EmailTemplateData = {
          recipientName: assignee.name,
          department,
          category: category.replace(/_/g, " ") as IndentCategory,
          action: actionText,
          frontendUrl: process.env.FRONTEND_URL || "https://your-app.com",
        };

        // Generate email subject
        const subject = generateEmailSubject(templateType);

        console.log(3, subject);
        // Render email template
        const emailBody = await renderModuleEmailTemplate(
          "indent",
          templateType,
          emailData
        );

        console.log(4, emailBody);
        // Add to email queue
        await addEmailToQueue({
          to: assignee.email,
          subject,
          body: emailBody,
          moduleType: Module.INDENT,
        });

        console.log(
          `Email queued for ${assignee.name} (${assignee.email}) - Template: ${templateType}`
        );
      } catch (error: any) {
        console.error(
          `Failed to queue email for ${assignee.name} (${assignee.email}):`,
          error
        );
        // Continue with other assignees even if one fails
      }
    }
