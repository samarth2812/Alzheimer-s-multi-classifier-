<AccordionSummary expandIcon={<ExpandMoreIcon />}>
  <Box sx={{ width: "100%" }}>
    {/* Subject + Top Right Actions */}
    <Box
      sx={{
        display: "flex",
        justifyContent: "space-between",
        alignItems: "flex-start",
        flexWrap: "wrap",
        gap: 1,
      }}
    >
      <Typography
        variant="subtitle1"
        fontWeight={600}
        sx={{
          flex: 1,
          maxWidth: "70%",
          wordBreak: "break-word",
        }}
      >
        {comm.subject}
      </Typography>

      <Box sx={{ display: "flex", alignItems: "center", gap: 1 }}>
        <Typography variant="body2" color="text.secondary">
          {comm.createdAt}
        </Typography>

        {comm.priorityLevel?.toLowerCase() === "high" && (
          <Chip
            icon={<PriorityHighIcon />}
            label="High Priority"
            color="error"
            size="small"
          />
        )}

        <Tooltip title="Reply">
          <IconButton
            size="small"
            onClick={(e) => {
              e.stopPropagation(); // Prevent accordion toggle
              onReply?.(comm);
            }}
          >
            <ReplyIcon fontSize="small" />
          </IconButton>
        </Tooltip>
      </Box>
    </Box>

    {/* From / To */}
    <Box
      sx={{
        mt: 0.5,
        fontSize: "0.85rem",
        color: "text.secondary",
        wordBreak: "break-word",
      }}
    >
      From: {comm.sentBy} | To: {comm.sentTo?.join(", ")}
    </Box>
  </Box>
</AccordionSummary>
