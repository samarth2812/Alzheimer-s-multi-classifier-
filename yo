import React from "react";
import {
  Box,
  Typography,
  List,
  ListItem,
  ListItemButton,
  ListItemText,
  ListItemIcon,
  Chip,
  Divider,
  Tooltip,
} from "@mui/material";
import PriorityHighIcon from "@mui/icons-material/PriorityHigh";
import MailOutlineIcon from "@mui/icons-material/MailOutline";

export default function CommunicationList({ communications = [], selectedId, onSelect }) {
  return (
    <List sx={{ width: "100%", p: 0 }}>
      {communications.map((comm, idx) => (
        <React.Fragment key={comm.id || idx}>
          <ListItem disablePadding selected={selectedId === comm.id}>
            <ListItemButton
              onClick={() => onSelect?.(comm.id)}
              sx={{
                display: "flex",
                alignItems: "flex-start",
                flexDirection: "column",
                alignItems: "stretch",
                px: 2,
                py: 1.5,
                borderLeft: selectedId === comm.id ? "4px solid #1976d2" : "4px solid transparent",
                backgroundColor: selectedId === comm.id ? "#f0f6ff" : "inherit",
              }}
            >
              <Box display="flex" justifyContent="space-between" alignItems="center" width="100%">
                <Typography variant="subtitle2" fontWeight={600} noWrap>
                  {comm.from || "Unknown Sender"}
                </Typography>
                {comm.priority && (
                  <Chip
                    size="small"
                    icon={<PriorityHighIcon sx={{ fontSize: "1rem" }} />}
                    label={comm.priority}
                    color="error"
                    variant="outlined"
                    sx={{ ml: 1 }}
                  />
                )}
              </Box>

              <Typography
                variant="body2"
                color="text.secondary"
                sx={{ fontSize: "0.75rem", mt: 0.5 }}
                noWrap
              >
                Category: {comm.category || "General"}
              </Typography>
              <Typography
                variant="body2"
                sx={{ fontWeight: 500, fontSize: "0.8rem" }}
                noWrap
              >
                {comm.subject || "(No Subject)"}
              </Typography>
            </ListItemButton>
          </ListItem>
          {idx < communications.length - 1 && <Divider component="li" sx={{ my: 0.5 }} />}
        </React.Fragment>
      ))}
    </List>
  );
}
